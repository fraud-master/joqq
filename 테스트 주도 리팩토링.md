# 테스트 주도 리팩토링(Test-Driven Refactoring)

테스트 주도 리팩토링은 기존 레거시 코드를 안전하게 개선하는 체계적인 접근 방식입니다. 이 방법의 핵심은 코드 변경 전에 테스트를 먼저 작성하여 안전망을 구축하는 것입니다.

## 주요 단계

### 1. 특성 테스트 작성 (Characterization Testing)
- **목적**: 현재 시스템의 동작을 문서화
- **방법**:
    - 현재 코드가 어떻게 동작하는지 관찰
    - 입력과 출력을 기록하는 테스트 작성
    - 버그도 포함하여 "있는 그대로" 테스트
- **중요성**: 이 테스트들은 리팩토링 과정에서 기존 기능이 보존되고 있는지 확인하는 기준점

### 2. 테스트 커버리지 확보
- 중요 기능과 경계 조건에 대한 테스트 우선 구현
- 점진적으로 테스트 커버리지 증가
- 복잡한 부분과 변경 가능성이 높은 부분에 집중

### 3. 단계적 리팩토링
- 작은 단위로 리팩토링 수행
- 각 변경 후 모든 테스트 실행
- 한 번에 한 가지 유형의 변경만 수행
- 테스트가 실패하면 즉시 롤백 또는 수정

### 4. 코드 품질 개선
- 중복 제거
- 메서드 추출
- 클래스 분리
- 인터페이스 개선
- 디자인 패턴 적용

### 5. 테스트 개선
- 리팩토링된 코드에 맞게 테스트 조정
- 새로운 테스트 케이스 추가
- 테스트 가독성 향상

## 실제 적용 전략

### 시밍 기법(Seam Strategy)
- 변경하기 어려운 코드에 "시밍(seam)"이라는 수정 지점 만들기
- 의존성 주입 활용하여 테스트 가능성 높이기

### 스프라우트 기법(Sprout Method/Class)
- 새로운 기능은 새 메서드/클래스로 만들어 테스트 후 통합
- 기존 코드 변경 최소화하며 새 기능 추가

### 랩핑 기법(Wrap Method/Class)
- 레거시 코드를 새 코드로 감싸기
- 점진적으로 내부 구현 대체

## 도구 활용

- 테스트 커버리지 분석 도구
- 정적 코드 분석 도구
- 리팩토링 지원 IDE 기능

## 주의사항

- 한 번에 너무 많은 변경 시도하지 않기
- 테스트 없이 리팩토링하지 않기
- 비즈니스 로직과 기술적 리팩토링 분리하기
- 리팩토링 목표와 범위 명확히 정의하기

이 방법론을 통해 레거시 코드를 점진적으로 개선하면서도 기존 기능의 안정성을 유지할 수 있습니다.
