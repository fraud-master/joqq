# 운영체제 관점에서의 스레드와 인터럽트

## 스레드 (Thread)

운영체제 관점에서 스레드는 CPU 활용의 기본 단위입니다. 프로세스 내에서 실행되는 흐름의 단위로, 동일한 프로세스 내의 스레드들은 메모리 공간과 자원을 공유합니다.

### 스레드의 주요 특성
1. **경량 프로세스(LWP)**: 프로세스보다 생성과 컨텍스트 스위칭 비용이 적음
2. **자원 공유**: 같은 프로세스 내의 스레드는 코드, 데이터, 힙 영역을 공유
3. **독립적 실행 흐름**: 각 스레드는 독립적인 프로그램 카운터와 스택을 가짐
4. **스케줄링 단위**: 스레드는 OS 스케줄러에 의해 독립적으로 스케줄링됨

### 스레드 구현 방식
1. **사용자 수준 스레드(User-level Thread)**:
    - 커널 개입 없이 사용자 공간에서 라이브러리로 구현
    - 커널은 스레드의 존재를 모름
    - 컨텍스트 스위칭이 빠름
    - 시스템 호출 시 전체 프로세스가 블록될 수 있음

2. **커널 수준 스레드(Kernel-level Thread)**:
    - 커널이 스레드를 관리
    - 스레드 연산이 시스템 콜을 통해 이루어짐
    - 한 스레드가 블록되어도 다른 스레드는 실행 가능
    - 컨텍스트 스위칭 비용이 높음

3. **혼합형 모델**:
    - 다대다 모델: 여러 사용자 수준 스레드를 더 적은 수의 커널 스레드에 매핑
    - 많은 현대 OS에서 채택

## 인터럽트 (Interrupt)

인터럽트는 CPU의 정상적인 실행 흐름을 일시적으로 중단시키고, 다른 루틴(인터럽트 핸들러)을 실행하도록 하는 신호입니다.

### 인터럽트의 종류
1. **하드웨어 인터럽트**:
    - 외부 장치(키보드, 마우스, 디스크 등)에서 발생
    - I/O 완료, 타이머 만료, 하드웨어 오류 등

2. **소프트웨어 인터럽트(트랩)**:
    - 프로그램 내에서 의도적으로 발생시킴
    - 시스템 콜, 예외 상황(0으로 나눔, 페이지 폴트 등)

3. **내부 인터럽트**:
    - CPU 내부에서 발생(산술 오류, 보호 위반 등)

### 인터럽트 처리 과정
1. 인터럽트 발생
2. 현재 실행 중인 명령어 완료
3. 현재 상태 저장(프로그램 카운터, 레지스터 등)
4. 인터럽트 벡터 테이블을 참조하여 해당 인터럽트 핸들러 주소 로드
5. 인터럽트 핸들러 실행
6. 인터럽트 처리 완료 후 저장된 상태 복원
7. 이전 실행 지점으로 복귀

## 스레드와 인터럽트의 관계

### 스레드 스케줄링과 인터럽트
1. **타임 슬라이스 종료**: 타이머 인터럽트를 통해 스레드의 실행 시간 제어
2. **선점형 스케줄링**: 인터럽트를 통해 높은 우선순위 스레드가 낮은 우선순위 스레드를 선점

### 스레드 동기화와 인터럽트
1. **인터럽트 비활성화**: 중요한 코드 섹션(임계 영역) 실행 시 일시적으로 인터럽트 비활성화
2. **인터럽트 상태 저장**: 인터럽트 핸들러 실행 시 스레드 컨텍스트 저장

### 자바에서의 스레드 인터럽트
1. **협력적 취소 메커니즘**: 강제 종료가 아닌 스레드에게 종료 요청을 알림
2. **인터럽트 상태 플래그**: 각 스레드는 인터럽트 상태를 가짐
3. **InterruptedException**: 블로킹 메서드가 인터럽트 발생 시 던지는 예외
4. **인터럽트 전파**: 인터럽트 상태를 보존하여 상위 호출자에게 전달

## 스레드 인터럽트의 활용

1. **작업 취소**: 장시간 실행되는 작업의 안전한 취소
2. **타임아웃 처리**: 일정 시간 내에 완료되지 않는 작업 중단
3. **리소스 정리**: 스레드 종료 전 자원 정리 기회 제공
4. **응답성 향상**: 사용자 요청에 빠르게 응답하기 위한 작업 중단

이러한 OS 수준의 개념들은 자바와 같은 고수준 언어에서도 그대로 반영되어, 스레드 관리와 인터럽트 처리 메커니즘의 기초가 됩니다.
